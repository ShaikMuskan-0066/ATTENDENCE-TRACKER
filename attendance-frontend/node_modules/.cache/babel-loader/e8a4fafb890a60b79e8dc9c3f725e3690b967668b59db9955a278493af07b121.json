{"ast":null,"code":"import _objectSpread from\"C:/Users/shaik/OneDrive/Desktop/attendance-tracker/attendance-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';import'./App.css';import StudentForm from'./components/StudentForm';import AttendanceTable from'./components/AttendanceTable';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=\"http://localhost:5000\";function App(){const[students,setStudents]=useState([]);const[attendance,setAttendance]=useState({});// ‚úÖ Load Students on Mount\nuseEffect(()=>{axios.get(\"\".concat(API,\"/students\")).then(res=>{setStudents(res.data);const init={};res.data.forEach(s=>init[s._id]='Present');setAttendance(init);}).catch(()=>alert(\"‚ùå Failed to load students.\"));},[]);// ‚úÖ Mark Present/Absent\nconst mark=(id,status)=>{setAttendance(prev=>_objectSpread(_objectSpread({},prev),{},{[id]:status}));};// ‚úÖ Save Attendance (Corrected!)\nconst save=()=>{const today=new Date().toISOString().split('T')[0];// YYYY-MM-DD\nconst records=students.map(s=>({name:s.name,rollNo:s.rollNo,parentMobile:s.parentMobile,student:s._id,status:attendance[s._id]||'Present',date:today}));console.log(\"üì§ Submitting attendance:\",records);axios.post(\"\".concat(API,\"/attendance\"),records).then(()=>alert(\"‚úÖ Attendance saved and SMS sent!\")).catch(err=>{var _err$response;console.error(\"‚ùå Error saving attendance:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);alert(\"‚ùå Failed to save attendance\");});};// ‚úÖ Download Excel Report\nconst downloadExcel=()=>{window.open(\"\".concat(API,\"/export/excel\"),'_blank');};// ‚úÖ Delete Student\nconst deleteStudent=async id=>{if(!window.confirm(\"Are you sure you want to delete this student?\"))return;await axios.delete(\"\".concat(API,\"/students/\").concat(id)).then(()=>{alert(\"üóëÔ∏è Student deleted\");setStudents(prev=>prev.filter(s=>s._id!==id));setAttendance(prev=>{const updated=_objectSpread({},prev);delete updated[id];return updated;});}).catch(()=>alert(\"‚ùå Failed to delete student\"));};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCD8 Attendance Tracker\"}),/*#__PURE__*/_jsx(StudentForm,{refresh:()=>window.location.reload()}),/*#__PURE__*/_jsx(AttendanceTable,{students:students,attendance:attendance,onMark:mark,onDelete:deleteStudent}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:save,children:\"\\u2705 Save Attendance\"}),/*#__PURE__*/_jsx(\"button\",{onClick:downloadExcel,children:\"\\uD83D\\uDCE5 Download Excel\"})]})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","axios","StudentForm","AttendanceTable","jsx","_jsx","jsxs","_jsxs","API","App","students","setStudents","attendance","setAttendance","get","concat","then","res","data","init","forEach","s","_id","catch","alert","mark","id","status","prev","_objectSpread","save","today","Date","toISOString","split","records","map","name","rollNo","parentMobile","student","date","console","log","post","err","_err$response","error","response","message","downloadExcel","window","open","deleteStudent","confirm","delete","filter","updated","className","children","refresh","location","reload","onMark","onDelete","onClick"],"sources":["C:/Users/shaik/OneDrive/Desktop/attendance-tracker/attendance-frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport './App.css';\nimport StudentForm from './components/StudentForm';\nimport AttendanceTable from './components/AttendanceTable';\n\nconst API = \"http://localhost:5000\";\n\n\nfunction App() {\n  const [students, setStudents] = useState([]);\n  const [attendance, setAttendance] = useState({});\n\n  // ‚úÖ Load Students on Mount\n  useEffect(() => {\n    axios.get(`${API}/students`)\n      .then(res => {\n        setStudents(res.data);\n        const init = {};\n        res.data.forEach(s => (init[s._id] = 'Present'));\n        setAttendance(init);\n      })\n      .catch(() => alert(\"‚ùå Failed to load students.\"));\n  }, []);\n\n  // ‚úÖ Mark Present/Absent\n  const mark = (id, status) => {\n    setAttendance(prev => ({ ...prev, [id]: status }));\n  };\n\n  // ‚úÖ Save Attendance (Corrected!)\n  const save = () => {\n  const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD\n\n  const records = students.map(s => ({\n    name: s.name,\n    rollNo: s.rollNo,\n    parentMobile: s.parentMobile,\n    student: s._id,\n    status: attendance[s._id] || 'Present',\n    date: today\n  }));\n\n  console.log(\"üì§ Submitting attendance:\", records);\n\n  axios.post(`${API}/attendance`, records)\n    .then(() => alert(\"‚úÖ Attendance saved and SMS sent!\"))\n    .catch(err => {\n      console.error(\"‚ùå Error saving attendance:\", err.response?.data || err.message);\n      alert(\"‚ùå Failed to save attendance\");\n    });\n};\n\n  // ‚úÖ Download Excel Report\n  const downloadExcel = () => {\n    window.open(`${API}/export/excel`, '_blank');\n  };\n\n  // ‚úÖ Delete Student\n  const deleteStudent = async (id) => {\n    if (!window.confirm(\"Are you sure you want to delete this student?\")) return;\n\n    await axios.delete(`${API}/students/${id}`)\n      .then(() => {\n        alert(\"üóëÔ∏è Student deleted\");\n        setStudents(prev => prev.filter(s => s._id !== id));\n        setAttendance(prev => {\n          const updated = { ...prev };\n          delete updated[id];\n          return updated;\n        });\n      })\n      .catch(() => alert(\"‚ùå Failed to delete student\"));\n  };\n\n  return (\n    <div className=\"container\">\n      <h1>üìò Attendance Tracker</h1>\n\n      <StudentForm refresh={() => window.location.reload()} />\n\n      <AttendanceTable\n        students={students}\n        attendance={attendance}\n        onMark={mark}\n        onDelete={deleteStudent}\n      />\n\n      <div className=\"action-buttons\">\n        <button onClick={save}>‚úÖ Save Attendance</button>\n        <button onClick={downloadExcel}>üì• Download Excel</button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}