{"ast":null,"code":"import _objectSpread from\"C:/Users/shaik/OneDrive/Desktop/attendance-tracker/attendance-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';import StudentForm from'./components/StudentForm';import AttendanceTable from'./components/AttendanceTable';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const API=\"http://localhost:5000\";function App(){const[students,setStudents]=useState([]);const[attendance,setAttendance]=useState({});// ‚úÖ Load Students on Mount\nuseEffect(()=>{axios.get(\"\".concat(API,\"/students\")).then(res=>{setStudents(res.data);const init={};res.data.forEach(s=>init[s._id]='Present');setAttendance(init);}).catch(()=>alert(\"‚ùå Failed to load students.\"));},[]);// ‚úÖ Mark Present/Absent\nconst mark=(id,status)=>{setAttendance(prev=>_objectSpread(_objectSpread({},prev),{},{[id]:status}));};// ‚úÖ Save Attendance (Corrected!)\nconst save=()=>{const records=students.map(s=>({name:s.name,rollNo:s.rollNo,parentMobile:s.parentMobile,student:s._id,status:attendance[s._id]||'Present'}));console.log(\"Submitting attendance:\",records);// Debug output\naxios.post(\"\".concat(API,\"/attendance\"),records,{withCredentials:true}).then(()=>alert(\"‚úÖ Attendance saved and SMS sent!\")).catch(err=>{var _err$response;console.error(\"Error saving attendance:\",((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message);alert(\"‚ùå Failed to save attendance\");});};// ‚úÖ Download Excel Report\nconst downloadExcel=()=>{window.open(\"\".concat(API,\"/export/excel\"),'_blank');};// ‚úÖ Delete Student\nconst deleteStudent=async id=>{if(!window.confirm(\"Are you sure you want to delete this student?\"))return;await axios.delete(\"\".concat(API,\"/students/\").concat(id)).then(()=>{alert(\"üóëÔ∏è Student deleted\");setStudents(prev=>prev.filter(s=>s._id!==id));setAttendance(prev=>{const updated=_objectSpread({},prev);delete updated[id];return updated;});}).catch(()=>alert(\"‚ùå Failed to delete student\"));};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD83D\\uDCD8 Attendance Tracker\"}),/*#__PURE__*/_jsx(StudentForm,{refresh:()=>window.location.reload()}),/*#__PURE__*/_jsx(AttendanceTable,{students:students,attendance:attendance,onMark:mark,onDelete:deleteStudent}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:save,children:\"\\u2705 Save Attendance\"}),/*#__PURE__*/_jsx(\"button\",{onClick:downloadExcel,children:\"\\uD83D\\uDCE5 Download Excel\"})]})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","axios","StudentForm","AttendanceTable","jsx","_jsx","jsxs","_jsxs","API","App","students","setStudents","attendance","setAttendance","get","concat","then","res","data","init","forEach","s","_id","catch","alert","mark","id","status","prev","_objectSpread","save","records","map","name","rollNo","parentMobile","student","console","log","post","withCredentials","err","_err$response","error","response","message","downloadExcel","window","open","deleteStudent","confirm","delete","filter","updated","className","children","refresh","location","reload","onMark","onDelete","onClick"],"sources":["C:/Users/shaik/OneDrive/Desktop/attendance-tracker/attendance-frontend/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport StudentForm from './components/StudentForm';\nimport AttendanceTable from './components/AttendanceTable';\n\nconst API =\"http://localhost:5000\";\n\n\nfunction App() {\n  const [students, setStudents] = useState([]);\n  const [attendance, setAttendance] = useState({});\n\n  // ‚úÖ Load Students on Mount\n  useEffect(() => {\n    axios.get(`${API}/students`)\n      .then(res => {\n        setStudents(res.data);\n        const init = {};\n        res.data.forEach(s => (init[s._id] = 'Present'));\n        setAttendance(init);\n      })\n      .catch(() => alert(\"‚ùå Failed to load students.\"));\n  }, []);\n\n  // ‚úÖ Mark Present/Absent\n  const mark = (id, status) => {\n    setAttendance(prev => ({ ...prev, [id]: status }));\n  };\n\n  // ‚úÖ Save Attendance (Corrected!)\n  const save = () => {\n    const records = students.map(s => ({\n      name: s.name,\n      rollNo: s.rollNo,\n      parentMobile: s.parentMobile,\n      student: s._id,\n      status: attendance[s._id] || 'Present'\n    }));\n\n    console.log(\"Submitting attendance:\", records); // Debug output\n\n    axios.post(`${API}/attendance`, records, { withCredentials: true })\n\n      .then(() => alert(\"‚úÖ Attendance saved and SMS sent!\"))\n      .catch(err => {\n        console.error(\"Error saving attendance:\", err.response?.data || err.message);\n        alert(\"‚ùå Failed to save attendance\");\n      });\n  };\n\n  // ‚úÖ Download Excel Report\n  const downloadExcel = () => {\n    window.open(`${API}/export/excel`, '_blank');\n  };\n\n  // ‚úÖ Delete Student\n  const deleteStudent = async (id) => {\n    if (!window.confirm(\"Are you sure you want to delete this student?\")) return;\n\n    await axios.delete(`${API}/students/${id}`)\n      .then(() => {\n        alert(\"üóëÔ∏è Student deleted\");\n        setStudents(prev => prev.filter(s => s._id !== id));\n        setAttendance(prev => {\n          const updated = { ...prev };\n          delete updated[id];\n          return updated;\n        });\n      })\n      .catch(() => alert(\"‚ùå Failed to delete student\"));\n  };\n\n  return (\n    <div className=\"container\">\n      <h1>üìò Attendance Tracker</h1>\n\n      <StudentForm refresh={() => window.location.reload()} />\n\n      <AttendanceTable\n        students={students}\n        attendance={attendance}\n        onMark={mark}\n        onDelete={deleteStudent}\n      />\n\n      <div className=\"action-buttons\">\n        <button onClick={save}>‚úÖ Save Attendance</button>\n        <button onClick={downloadExcel}>üì• Download Excel</button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}